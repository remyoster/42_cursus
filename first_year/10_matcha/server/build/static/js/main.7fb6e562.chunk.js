(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{117:function(e,t){},146:function(e,t,a){},147:function(e,t,a){},154:function(e,t,a){},163:function(e,t,a){},164:function(e,t,a){},165:function(e,t,a){},166:function(e,t,a){},167:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(28),l=a.n(c),i=a(1),s=a(8),u=a(81),o=a.n(u)()("localhost:3001"),m=r.a.createContext();function d(e,t){switch(t.type){case"LOGIN":var a=Object(s.a)({},e,{login:!0,id_session:t.id,username:t.username,token:t.token,img:t.img});return localStorage.setItem("store",JSON.stringify(a)),o.emit("login",t.id),a;case"LOGOUT":return localStorage.removeItem("store"),o.emit("logout",e.id_session),Object(s.a)({},e,{login:!1,id_session:"",username:"",token:"",img:"/public/img/avatar.png"});case"CHANGE_AVATAR":var n=Object(s.a)({},e,{img:t.payload});return localStorage.setItem("store",JSON.stringify(n)),n;case"PROFIL":var r=Object(s.a)({},e,{profil:t.profil});return localStorage.setItem("store",JSON.stringify(r)),r;default:return e}}var p=a(2),f=a.n(p),v=a(4),E=a(3),g=a.n(E),h=r.a.createContext(),b={cat:"",mail:"",lastname:"",firstname:"",bio:"",gender:"",sexpref:"",ageMin:"",ageMax:"",defaultAge:"",birthdate:"",localMax:"",city:"",lat:"",lon:"",popularMin:"",popularMax:"",defaultPopular:"",defaultTags:[],tags:[],visits:[],likes:[],matchs:[],blocks:[],filter:{sex:!0,age:!1,local:!1,popular:!1,tags:!1,search:{bool:!1}},loaded:!1,lastco:""};function O(e,t){switch(t.type){case"INIT":return t.payload;case"CHANGE_CIVIL":return Object(s.a)({},e,{lastname:t.lastname,firstname:t.firstname,gender:t.gender});case"CHANGE_PUBLIC":return Object(s.a)({},e,{sexpref:t.sexpref,bio:t.bio,city:t.city,lat:t.lat,lon:t.lon});case"CHANGE_TAGS":return Object(s.a)({},e,{defaultTags:t.tags,tags:t.tags});case"CHANGE_MAIL":return Object(s.a)({},e,{mail:t.mail});case"SEARCHSHOW":return Object(s.a)({},e,{cat:t.cat});case"SEARCHAGE":return Object(s.a)({},e,{ageMin:t.ageMin,ageMax:t.ageMax});case"SEARCHLOCAL":return Object(s.a)({},e,{localMax:t.localMax});case"SEARCHPOPULAR":return Object(s.a)({},e,{popularMin:t.popularMin,popularMax:t.popularMax});case"SEARCHSEXPREF":return Object(s.a)({},e,{sexpref:t.sexpref});case"SEARCHTAGS":return Object(s.a)({},e,{tags:t.tags});case"SEARCHFILTER":return Object(s.a)({},e,{filter:t.filter});case"NEW_VISIT":return Object(s.a)({},e,{visits:t.payload});case"NEW_LIKE":return Object(s.a)({},e,{likes:t.payload});case"NEW_UNLIKE":case"NEW_MATCH":return Object(s.a)({},e,{likes:t.likes,matchs:t.matchs});case"NEW_BLOCK":return Object(s.a)({},e,{blocks:t.payload});case"NEW_GAME":return Object(s.a)({},e,{visits:t.visits,likes:t.likes});case"UP_LASTCO":return Object(s.a)({},e,{lastco:t.payload});default:return e}}var k=a(17),j=a(6),y=a(5);function _(){var e=Object(n.useContext)(m).state;function t(){var e=document.getElementById("topnav");""===e.className?e.className="responsive":e.className=""}return e.login?r.a.createElement("nav",{id:"topnav"},r.a.createElement(x,{to:"",className:"icon",onClick:t},r.a.createElement(j.a,{icon:y.b})),r.a.createElement(x,{to:"/"},"Match")," ",r.a.createElement(x,{to:"/jouer"},"Jouer")," ",r.a.createElement(x,{to:"/profil"},r.a.createElement("img",{src:e.img,alt:"avatar",className:"avatar"}),e.username)," ",r.a.createElement(x,{to:"/deconnexion"},r.a.createElement(j.a,{icon:y.n}),r.a.createElement("span",{className:"infobulle"},"Deconnexion"))):r.a.createElement("nav",{id:"topnav"},r.a.createElement(x,{to:"",className:"icon",onClick:t},r.a.createElement(j.a,{icon:y.b})),r.a.createElement(x,{to:"/"},"Match")," ",r.a.createElement(x,{to:"/connexion"},"Connexion")," ",r.a.createElement(x,{to:"/inscription"},"S'inscrire")," ")}function x(e){return r.a.createElement(k.a,Object.assign({},e,{getProps:function(e){return{style:{color:e.isCurrent?"#374140":"#f8f9f4"}}}}))}function N(){var e=Object(n.useState)(7),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)(function(){var e=setInterval(function(){c(a-1)},1e3);return function(){clearInterval(e)}}),0===a&&Object(k.c)("/"),r.a.createElement(r.a.Fragment,null,r.a.createElement(_,null),r.a.createElement("p",null,"D\xe9sol\xe9 cette page n'existe pas"),r.a.createElement("p",null,"Vous serez redirig\xe9 dans ",a,"..."))}var C=a(7),S=a(32),w=(a(146),"UP_LASTCO");function I(){var e=Object(n.useContext)(m).state,t=Object(n.useContext)(h),a=t.search,c=t.dispatchSearch,l=Object(n.useState)(a.matchs),u=Object(i.a)(l,2),d=u[0],p=u[1],E=Object(n.useState)([]),b=Object(i.a)(E,2),O=b[0],k=b[1],_=Object(n.useState)({}),x=Object(i.a)(_,2),N=x[0],I=x[1],M=Object(n.useState)([]),A=Object(i.a)(M,2),U=A[0],L=A[1],F=Object(n.useState)(null),D=Object(i.a)(F,2),R=D[0],H=D[1],P=Object(n.useState)(null),K=Object(i.a)(P,2),B=K[0],q=K[1],W=Object(n.useState)([]),G=Object(i.a)(W,2),z=G[0],V=G[1];function J(){return(J=Object(v.a)(f.a.mark(function t(a,n){var r,l,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(c({type:w,payload:new Date}),!(O.findIndex(function(e){return e.id_user===n.id_user})>-1)){t.next=6;break}k(O.filter(function(e){return e.id_user!==n.id_user})),t.next=14;break;case 6:return t.next=8,T(n.id_user,e.id_session);case 8:r=t.sent,k([].concat(Object(C.a)(O),[Object(s.a)({},n,{messages:r})])),l=Object(C.a)(d),i=l.findIndex(function(e){return e.id_user===n.id_user}),l[i].newmess=0,p(l);case 14:case"end":return t.stop()}},t)}))).apply(this,arguments)}return Object(n.useEffect)(function(){q(document.getElementById("chatUsers"))},[]),Object(n.useEffect)(function(){var t=g.a.CancelToken.source();function n(){return(n=Object(v.a)(f.a.mark(function n(r,c){var l,i,s,u;return f.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,g.a.get("user/others/chat/".concat(r),{cancelToken:t.token});case 3:if(!(l=n.sent).data){n.next=12;break}return i=a.blocks.map(function(e){return e.id_blocked}),s=l.data.filter(function(e){return!i.includes(e.id_user)}),n.next=9,g.a.get("/user/chat/".concat(e.id_session,"/").concat(c),{cancelToken:t.token});case 9:(l=n.sent).data&&l.data.length>0&&(L(l.data),l.data.forEach(function(e){(u=s.findIndex(function(t){return t.id_user===e.id_author}))>-1&&(s[u].newmess=e.count)})),p(s);case 12:n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),g.a.isCancel(n.t0)?t.cancel():H("Une erreur est survenue.");case 17:case"end":return n.stop()}},n,null,[[0,14]])}))).apply(this,arguments)}if(a.matchs.length>0&&a.lastco){var r=a.matchs.map(function(t){return t.id_user1!==e.id_session?t.id_user1:t.id_user2}).join(","),c=new Date(a.lastco);(function(e,t){n.apply(this,arguments)})(r,c="".concat(c.getFullYear(),"-").concat(c.getMonth()+1,"-").concat(c.getDate()," ").concat(c.getHours(),":").concat(c.getMinutes(),":").concat(c.getSeconds()))}return function(){t.cancel()}},[a.matchs,e.id_session,a.blocks,a.lastco]),Object(n.useEffect)(function(){0===a.matchs.length&&d.length>0&&(k([]),p([]))},[a.matchs,d]),Object(n.useEffect)(function(){o.on("mess",function(e){var t=O.findIndex(function(t){return t.id_user===e.id_author});if(t>-1){var a=Object(C.a)(O);a[t].messages.push(e),k(a),c({type:w,payload:new Date})}else{t=U.findIndex(function(t){return t.id_author===e.id_author});var n=Object(C.a)(U);t>-1?n[t].count=n[t].count+1:(t=0,n.push({id_author:e.id_author,count:1})),L(n),p(d.map(function(a){return a.id_user===e.id_author?Object(s.a)({},a,{newmess:n[t].count}):a}))}});for(var e=document.getElementsByClassName("chatWindowContent"),t=0;t<e.length;t++)e[t].scrollTop=e[t].scrollHeight;return function(){o.removeListener("mess")}},[O,e.id_session,d,U,c]),Object(n.useEffect)(function(){var e=setInterval(function(){o.emit("getSocketUsers"),o.on("getSocketUsers",function(e){V(e)})},5e3);return function(){o.removeListener("getSocketUsers"),clearInterval(e)}},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"chat-bar",onClick:function(){"block"===B.style.display?(O.length>0&&k([]),B.style.display="none"):(o.emit("getSocketUsers"),B.style.display="block"),U.length>0&&L([])}},r.a.createElement(j.a,{icon:y.j,className:"header-icon"}),U.length>0&&B&&"block"!==B.style.display&&r.a.createElement("span",{className:"notif-counter"},U.length)),r.a.createElement("ul",{className:"chatWindow-wrapper"},r.a.createElement("ul",{id:"chatUsers"},d.map(function(e,t){return r.a.createElement("li",{key:t,className:"chatUser",onClick:function(t){!function(e,t){J.apply(this,arguments)}(t,e)}},r.a.createElement("img",{className:"chatUserPic",src:e.img||"/public/img/avatar.png",alt:"".concat(e.username,"-mainPic")}),e.username," ",r.a.createElement(j.a,{className:"online-icon",icon:y.h,style:{color:z.includes(e.id_user)?"green":"grey"}}),e.newmess>0&&r.a.createElement("span",{className:"notif-counter"},e.newmess))}),0===d.length&&r.a.createElement("li",null,"Vous devez matcher pour discuter ;)"),R&&r.a.createElement("li",null,R)),O&&O.map(function(t,a){return r.a.createElement("li",{key:a,className:"chatWindow"},r.a.createElement("div",{className:"chatWindowHeader",onClick:function(){return e=t.id_user,void k(O.filter(function(t){return t.id_user!==e}));var e}},r.a.createElement("img",{className:"chatUserPic",src:t.img||"public/img/avatar.png",alt:"".concat(t.username,"-mainPic")}),t.username),r.a.createElement("div",{className:"chatWindowContent"},r.a.createElement("ul",null,t.messages&&t.messages.map(function(t,a){return r.a.createElement("li",{key:a,style:{backgroundColor:t.id_author===e.id_session?"#8EC83C":"#D8EED8",marginLeft:t.id_author===e.id_session?"auto":"0px"}},t.mess)}))),r.a.createElement("form",{onSubmit:function(a){!function(t,a){t.preventDefault(),o.emit("chat-message",{id_author:e.id_session,id_receiver:a.id_user,mess:N[a.id_user]});var n=O.findIndex(function(e){return e.id_user===a.id_user}),r=Object(C.a)(O);r[n].messages=[].concat(Object(C.a)(a.messages),[{id_author:e.id_session,mess:N[a.id_user]}]),k(r),I(Object(s.a)({},N,Object(S.a)({},a.id_user,"")))}(a,t)}},r.a.createElement("textarea",{autoFocus:!0,placeholder:"Ecrivez",value:N[t.id_user],onChange:function(e){!function(e,t){I(Object(s.a)({},N,Object(S.a)({},t.id_user,e.target.value)))}(e,t)},onKeyDown:function(e){return function(e,t){if("Enter"===e.key&&!e.shiftKey){e.preventDefault();var a=new MouseEvent("click");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.getElementById("submit".concat(t.id_user)).dispatchEvent(a)}}(e,t)}}),r.a.createElement("input",{id:"submit".concat(t.id_user),type:"submit",value:"\u21d2"})))})))}function M(e){e=new Date(e);var t=(new Date-e)/36e5;return e=(t=t<0?-t:t)>24?e.getDate()+"/"+(e.getMonth()+1)+"-"+e.toTimeString().slice(0,5):e.toTimeString().slice(0,5)}function T(e,t){return A.apply(this,arguments)}function A(){return(A=Object(v.a)(f.a.mark(function e(t,a){var n,r,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("/user/message/".concat(a,",").concat(t));case 3:if(!(n=e.sent).data){e.next=11;break}return r=M(n.data[n.data.length-1].date),(c=n.data.map(function(e){return{id_author:e.id_author,mess:e.content}})).push({id_author:-1,mess:r}),e.abrupt("return",c);case 11:return e.abrupt("return",[]);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",[]);case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}var U="UP_LASTCO";function L(){var e=Object(n.useContext)(m).state,t=Object(n.useContext)(h),a=t.search,c=t.dispatchSearch,l=Object(n.useState)(0),s=Object(i.a)(l,2),u=s[0],d=s[1],p=Object(n.useState)(null),E=Object(i.a)(p,2),b=E[0],O=E[1];function k(){return(k=Object(v.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"block"===(t=document.getElementById("notif-wrapper")).style.display?t.style.display="none":(t.style.display="block",c({type:U,payload:new Date})),u>0&&d(0);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){return o.on("notif",function(t){if("visit"===t.type)c({type:"NEW_VISIT",payload:[].concat(Object(C.a)(a.visits),[{id_visitor:t.id_author,id_visited:e.id_session}])});else if("like"===t.type)c({type:"NEW_LIKE",payload:[].concat(Object(C.a)(a.likes),[{id_liked:e.id_session,id_author:t.id_author}])});else if("unlike"===t.type){var n=Object(C.a)(a.matchs);t.delete&&(n=n.filter(function(e){return e.id_match!==t.delete})),c({type:"NEW_UNLIKE",likes:a.likes.filter(function(e){return e.id_like!==t.id_like}),matchs:n})}else if("match"===t.type){var r=!0===t.bol?[].concat(Object(C.a)(a.likes),[{id_like:t.id_like,id_liked:e.id_session,id_author:t.id_author}]):[].concat(Object(C.a)(a.likes),[{id_like:t.id_like,id_liked:t.id_author,id_author:e.id_session}]);c({type:"NEW_MATCH",likes:r,matchs:[].concat(Object(C.a)(a.matchs),[{id_match:t.id_match,id_user1:e.id_session,id_user2:t.id_author}])})}else"game"===t.type&&c({type:"NEW_GAME",visits:[].concat(Object(C.a)(a.visits),[{id_visit:t.id_visit,id_visitor:t.id_author,id_visited:e.id_session}]),likes:[].concat(Object(C.a)(a.likes),[{id_like:t.id_like,id_liked:e.id_session,id_author:t.id_author}])});d(u+1)}),function(){o.removeListener("notif")}},[e,a,u,c]),Object(n.useEffect)(function(){function t(){return(t=Object(v.a)(f.a.mark(function t(){var n,r,c,l;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.a.get("/user/notif/".concat(e.id_session));case 3:if(!((n=t.sent).data&&n.data.length>0)){t.next=14;break}return r=new Date(a.lastco),c=n.data.map(function(e){return e.date=new Date(e.date),e}),l=0,c.forEach(function(e){r-e.date<0&&l++}),O(c),d(l),t.abrupt("return",[n.data,l]);case 14:return t.abrupt("return",null);case 15:t.next=20;break;case 17:return t.prev=17,t.t0=t.catch(0),t.abrupt("return",null);case 20:case"end":return t.stop()}},t,null,[[0,17]])}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[e.id_session,a.lastco]),r.a.createElement("div",{id:"notif-bar",onClick:function(){return k.apply(this,arguments)}},r.a.createElement(j.a,{icon:y.c,className:"header-icon"}),u>0&&r.a.createElement("span",{className:"notif-counter"},u),r.a.createElement("ul",{id:"notif-wrapper"},b?b.map(function(e,t){return r.a.createElement("li",{key:t,className:"notif"},r.a.createElement("img",{className:"notifUserPic",src:e.img||"/public/img/avatar.png",alt:"".concat(e.id_author,"-mainPic")}),function(e,t){if("visit"===e)return"".concat(t," \xe0 visit\xe9 votre profil.");if("like"===e)return"".concat(t," vous \xe0 lik\xe9 !");if("unlike"===e)return"".concat(t," ne vous aime plus...");if("match"===e)return"Vous avez un nouveau match avec ".concat(t," !!");if("game"===e)return"Votre profil a \xe9t\xe9 sugg\xe9r\xe9 et aim\xe9 par ".concat(t," !")}(e.type,e.username),r.a.createElement("br",null),"(",M(e.date),")")}):r.a.createElement("li",null,"Vous n'avez aucune notification")))}a(147);function F(){return Object(n.useContext)(m).state.login?r.a.createElement("header",null,r.a.createElement(_,null),r.a.createElement(L,null),r.a.createElement(I,null)):r.a.createElement("header",null,r.a.createElement(_,null))}a(52);function D(e){var t=Object(n.useState)(e),a=Object(i.a)(t,2),r=a[0],c=a[1];return{value:r,onChange:function(e){c(e.target.value)}}}var R=a(182),H=a(181),P=a(177),K=a(180),B=a(179),q=(a(148),a(14)),W=a.n(q);function G(e){delete W.a.Icon.Default.prototype._getIconUrl,W.a.Icon.Default.mergeOptions({iconRetinaUrl:a(149),iconUrl:a(150),shadowUrl:a(151)});var t=e.index;return r.a.createElement(R.a,{center:""!==e.coord[0]&&0!==e.coord[0]?e.coord:[48.8534,2.3488],zoom:12,minZoom:2,maxZoom:18,style:{height:350,zIndex:0}},r.a.createElement(H.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"}),""!==e.coord[0]&&0!==e.coord[0]&&r.a.createElement(P.a,{position:e.coord},r.a.createElement(K.a,null,"Moi")),"number"!==typeof t&&e.others.length>0&&e.others.map(function(e,t){return r.a.createElement(B.a,{key:"circle-".concat(t),center:[e.latitude,e.longitude],radius:350},r.a.createElement(K.a,null,e.username))}),"number"===typeof t&&e.others.length>0&&e.others[t]&&r.a.createElement(B.a,{center:[e.others[t].latitude,e.others[t].longitude],radius:350},r.a.createElement(K.a,null,e.others[t].username)))}var z=a(178);a(154);function V(){var e=Object(n.useContext)(h),t=e.search,a=e.dispatchSearch,c=Object(n.useState)([]),l=Object(i.a)(c,2),u=l[0],o=l[1],m=Object(n.useState)([t.ageMin||18,t.ageMax||28]),d=Object(i.a)(m,2),p=d[0],E=d[1],b=Object(n.useState)([t.popularMin||0,t.popularMax||10]),O=Object(i.a)(b,2),k=O[0],_=O[1],x=Object(n.useState)(t.localMax||10),N=Object(i.a)(x,2),S=N[0],w=N[1],I=Object(n.useState)(t.filter.search.val||""),M=Object(i.a)(I,2),T=M[0],A=M[1],U=Object(n.useState)(null),L=Object(i.a)(U,2),F=L[0],D=L[1],R=t.sexpref;function H(){"sugg"!==t.cat&&a({type:"SEARCHSHOW",cat:"sugg"})}function P(){"likes"!==t.cat&&a({type:"SEARCHSHOW",cat:"likes"})}function K(){"matchs"!==t.cat&&a({type:"SEARCHSHOW",cat:"matchs"})}function B(){"visits"!==t.cat&&a({type:"SEARCHSHOW",cat:"visits"})}function q(e){var n=Object(s.a)({},t.filter);"sex"===e.target.id?t.filter.sex?n.sex=!1:n.sex=!0:"age"===e.target.id?t.filter.age?n.age=!1:n.age=!0:"local"===e.target.id?t.filter.local?n.local=!1:n.local=!0:"popular"===e.target.id?t.filter.popular?n.popular=!1:n.popular=!0:"tags"===e.target.id?t.filter.tags?n.tags=!1:n.tags=!0:"search"===e.target.id&&(t.filter.search.bool?n.search.bool=!1:n.search.bool=!0,n.search.bool&&T.length>3&&(n.search.val=T)),a({type:"SEARCHFILTER",filter:n})}return Object(n.useEffect)(function(){var e=g.a.CancelToken.source();function a(){return(a=Object(v.a)(f.a.mark(function a(){var n,r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.a.get("/interest",{cancelToken:e.token});case 3:(n=a.sent).data&&(r=t.tags.map(function(e){return e.id_interest}),o(n.data.filter(function(e){return!r.includes(e.id_interest)}))),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),g.a.isCancel(a.t0)?e.cancel():D("Une erreur est survenue.");case 10:case"end":return a.stop()}},a,null,[[0,7]])}))).apply(this,arguments)}return t.loaded&&function(){a.apply(this,arguments)}(),function(){e.cancel()}},[t.tags,t.loaded]),Object(n.useEffect)(function(){t.ageMin&&t.ageMax&&E([t.ageMin,t.ageMax]),t.popularMin&&t.popularMax&&_([t.popularMin,t.popularMax])},[t.ageMin,t.ageMax,t.popularMin,t.popularMax]),r.a.createElement("div",{id:"searchBar"},r.a.createElement("nav",null,r.a.createElement("ul",null,"sugg"===t.cat?r.a.createElement("li",{className:"currentSearch",onClick:H},r.a.createElement(j.a,{icon:y.i})):r.a.createElement("li",{onClick:H},r.a.createElement(j.a,{icon:y.i})),"visits"===t.cat?r.a.createElement("li",{className:"currentSearch",onClick:B},r.a.createElement(j.a,{icon:y.l})):r.a.createElement("li",{onClick:B},r.a.createElement(j.a,{icon:y.l})),"likes"===t.cat?r.a.createElement("li",{className:"currentSearch",onClick:P},r.a.createElement(j.a,{icon:y.m})):r.a.createElement("li",{onClick:P},r.a.createElement(j.a,{icon:y.m})),"matchs"===t.cat?r.a.createElement("li",{className:"currentSearch",onClick:K},r.a.createElement(j.a,{icon:y.o})):r.a.createElement("li",{onClick:K},r.a.createElement(j.a,{icon:y.o})))),r.a.createElement("div",null,r.a.createElement("h4",null,"Les filtres de recherche:"),r.a.createElement("div",{className:"titleSlide"},r.a.createElement("input",{id:"sex",type:"checkbox",onChange:q,checked:!!t.filter.sex}),r.a.createElement("label",{htmlFor:"sex"},"Sexe")),r.a.createElement("div",{className:"sexpref"},r.a.createElement("select",{value:R,onChange:function(e){a({type:"SEARCHSEXPREF",sexpref:e.target.value})},className:"searchSex"},r.a.createElement("option",{value:"bi"},"\u26a4 (Bi)"),r.a.createElement("option",{value:"female"},"\u2640 (F)"),r.a.createElement("option",{value:"male"},"\u2642 (M)"),r.a.createElement("option",{value:"other"},"\u26ac (Autre)"))),r.a.createElement("div",{className:"titleSlide"},r.a.createElement("input",{id:"age",type:"checkbox",onChange:q,checked:!!t.filter.age}),r.a.createElement("label",{htmlFor:"age"},"Age")),r.a.createElement("div",{className:t.filter.age?"slideActiv":"slide"},r.a.createElement(z.a,{min:18,max:80,step:1,value:p,onChange:function(e,t){E(t)},onChangeCommitted:function(e,t){a({type:"SEARCHAGE",ageMin:t[0],ageMax:t[1]})},valueLabelDisplay:"on","aria-labelledby":"range-slider","aria-label":"test"})),r.a.createElement("div",{className:"titleSlide"},r.a.createElement("input",{id:"local",type:"checkbox",onChange:q,checked:!!t.filter.local}),r.a.createElement("label",{htmlFor:"local"},"Localisation")),r.a.createElement("div",{className:t.filter.local?"slideActiv":"slide"},r.a.createElement(z.a,{min:10,max:1e3,value:S,step:5,onChange:function(e,t){w(t)},onChangeCommitted:function(e,t){a({type:"SEARCHLOCAL",localMax:t})},valueLabelDisplay:"on","aria-labelledby":"range-slider"})),r.a.createElement("div",{className:"titleSlide"},r.a.createElement("input",{id:"popular",type:"checkbox",onChange:q,checked:!!t.filter.popular}),r.a.createElement("label",{htmlFor:"popular"},"Popularit\xe9")),r.a.createElement("div",{className:t.filter.popular?"slideActiv":"slide"},r.a.createElement(z.a,{min:0,max:200,value:k,step:1,onChange:function(e,t){_(t)},onChangeCommitted:function(e,t){a({type:"SEARCHPOPULAR",popularMin:t[0],popularMax:t[1]})},valueLabelDisplay:"on","aria-labelledby":"range-slider"})),r.a.createElement("div",{className:"titleSlide"},r.a.createElement("input",{id:"tags",type:"checkbox",onChange:q,checked:!!t.filter.tags}),r.a.createElement("label",{htmlFor:"tags"},"Tags")),r.a.createElement("div",{className:"sexpref"},r.a.createElement("ul",{className:"tagSearch"},t.tags&&t.tags.map(function(e,n){return r.a.createElement("li",{key:n,onClick:function(){return function(e){var n=t.tags.find(function(t){return t.id_interest===e});if(n){var r=t.tags.filter(function(e){return n.id_interest!==e.id_interest});a({type:"SEARCHTAGS",tags:r})}}(e.id_interest)},className:"listDel"}," ",e.name_interest," ",r.a.createElement(j.a,{icon:y.p}))})),r.a.createElement("ul",{className:"tagSearch"},u&&u.map(function(e,n){return r.a.createElement("li",{key:n,onClick:function(){return function(e){var n=u.find(function(t){return t.id_interest===e}),r=[].concat(Object(C.a)(t.tags),[n]);a({type:"SEARCHTAGS",tags:r})}(e.id_interest)},className:"listAdd"},e.name_interest," ",r.a.createElement(j.a,{icon:y.d}))})),F&&r.a.createElement("p",null,F)),r.a.createElement("div",{className:"titleSlide"},r.a.createElement("input",{id:"search",type:"checkbox",onChange:q,checked:!!t.filter.search.bool}),r.a.createElement("label",{htmlFor:"search"},"Recherche")),r.a.createElement("input",{type:"text",value:T,onChange:function(e){A(e.target.value),!0!==t.filter.search.bool||!/^[a-zA-Z]+$/.test(e.target.value)&&""!==e.target.value||a({type:"SEARCHFILTER",filter:Object(s.a)({},t.filter,{search:{bool:!0,val:e.target.value}})})}})))}function J(e){var t=Object(n.useContext)(h),a=t.search,c=t.dispatchSearch,l=e.state,s=Object(n.useState)({}),u=Object(i.a)(s,2),m=u[0],d=u[1],p=Object(n.useState)([]),E=Object(i.a)(p,2),b=E[0],O=E[1],k=Object(n.useState)(!1),_=Object(i.a)(k,2),x=_[0],N=_[1],S=Object(n.useState)(!1),w=Object(i.a)(S,2),I=w[0],M=w[1],T=Object(n.useState)(""),A=Object(i.a)(T,2),U=A[0],L=A[1],F=Object(n.useState)(!0),D=Object(i.a)(F,2),R=D[0],H=D[1],P=Object(n.useState)(0),K=Object(i.a)(P,2),B=K[0],q=K[1],W=Object(n.useState)([]),z=Object(i.a)(W,2),J=z[0],Q=z[1],ee=Object(n.useState)(null),te=Object(i.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)([]),ce=Object(i.a)(re,2),le=ce[0],ie=ce[1];function se(){N(!x)}function ue(){M(!I)}function oe(){"block"===document.getElementById("report").style.display?document.getElementById("report").style.display="none":document.getElementById("report").style.display="block"}function me(){return(me=Object(v.a)(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.id_user,e.prev=1,e.next=4,g.a.post("/user/others/block",{id:l.id_session,id_blocked:t,token:l.token});case 4:(n=e.sent).data&&(c({type:"NEW_BLOCK",payload:[].concat(Object(C.a)(a.blocks),[{id:n.data.result,id_author:l.id_session,id_blocked:t}])}),document.getElementById("modal").style.display="none"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),ne("Une erreur est survenue.");case 11:oe();case 12:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}return Object(n.useEffect)(function(){function e(e){var t=document.getElementById("modal");e.target===t&&(t.style.display="none")}return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}}),Object(n.useEffect)(function(){var t=[],n=l.id_session;if("visits"===a.cat)t=X(a.visits,e.others,n,x);else if("likes"===a.cat)t=function(e,t,a,n){return n?t.filter(function(t){return e.filter(function(e){return e.id_author===a}).map(function(e){return e.id_liked}).includes(t.id_user)}):t.filter(function(t){return e.filter(function(e){return e.id_liked===a}).map(function(e){return e.id_author}).includes(t.id_user)})}(a.likes,e.others,n,I);else if("matchs"===a.cat)t=function(e,t,a){for(var n=[],r=0;r<e.length;r++)e[r].id_user1===a?n.push(e[r].id_user2):n.push(e[r].id_user1);return t.filter(function(e){return n.includes(e.id_user)})}(a.matchs,e.others,n);else{var r=X(a.visits,e.others,n,!0).map(function(e){return e.id_user});t=e.others.filter(function(e){return!r.includes(e.id_user)})}t=function(e,t){e.length>0&&(t=(t=t.filter(function(t){return!e.map(function(e){return e.id_blocked}).includes(t.id_user)})).filter(function(t){return!e.map(function(e){return e.id_author}).includes(t.id_user)}));return t}(a.blocks,t);var c=function(e,t){var a=t;e.filter.sex&&(a=t.filter(function(t){return"bi"===e.sexpref?"male"===t.gender||"female"===t.gender:t.gender===e.sexpref}).filter(function(t){return"male"===e.gender?"bi"===t.sexpref||"male"===t.sexpref:"female"===e.gender?"bi"===t.sexpref||"female"===t.sexpref:"other"===t.sexpref}));e.filter.age&&(a=a.filter(function(t){return t.age>=e.ageMin&&t.age<=e.ageMax}));e.filter.local&&(a=a.filter(function(t){return $(t.latitude,t.longitude,e.lat,e.lon)<=e.localMax}));e.filter.popular&&(a=a.filter(function(t){return t.popular>=e.popularMin&&t.popular<=e.popularMax}));e.filter.tags&&(a=a.filter(function(t){return e.tags.map(function(e){return e.name_interest}).every(function(e){return t.interest.includes(e)})}));if(e.filter.search&&!0===e.filter.search.bool&&e.filter.search.val&&/^[a-zA-Z]+$/.test(e.filter.search.val)){var n=new RegExp(e.filter.search.val,"i");a=a.filter(function(e){return e.username.match(n)||e.firstname.match(n)})}return a}(a,t);""!==U&&(c=Y(c,U,a,R)),O(c),q(0)},[e.others,a,x,I,l.id_session,U,R]),Object(n.useEffect)(function(){b.length>10?Q(b.slice(0,10*(B+1))):Q(b)},[b,B]),Object(n.useEffect)(function(){var e=setInterval(function(){o.emit("getSocketUsers"),o.on("getSocketUsers",function(e){ie(e)})},5e3);return function(){o.removeListener("getSocketUsers"),clearInterval(e)}},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"mainContain"},ae&&r.a.createElement("p",null,ae),r.a.createElement(V,null),r.a.createElement("div",{id:"gallery"},r.a.createElement("div",{className:"sortsearch"},r.a.createElement("select",{defaultValue:"default",onChange:function(e){var t=parseInt(e.target.value),n=Object(C.a)(b);b&&(1===t?(n=Y(n,"age",a,R),L("age")):2===t?(n=Y(n,"localisation",a,R),L("localisation")):3===t?(n=Y(n,"popular",a,R),L("popular")):4===t&&(n=Y(n,"tags",a,R),L("tags")),O(n))}},r.a.createElement("option",{disabled:!0,value:"default"},"Trier par :"),r.a.createElement("option",{value:"1"},"\xc2ge"),r.a.createElement("option",{value:"2"},"Localisation"),r.a.createElement("option",{value:"3"},"Popularit\xe9"),r.a.createElement("option",{value:"4"},"Tags commun")),r.a.createElement("select",{defaultValue:"1",onChange:function(e){var t=parseInt(e.target.value);1===t&&!1===R?H(!0):0===t&&!0===R&&H(!1)}},r.a.createElement("option",{value:"1"},"\u2227"),r.a.createElement("option",{value:"0"},"\u2228"))),e.loading&&r.a.createElement("img",{className:"loader",src:"/public/img/ajax-loader.gif",alt:"loader"}),"visits"===a.cat&&x&&r.a.createElement("div",{className:"lineToggle"},r.a.createElement("h3",null,"Tu as regard\xe9 leur profil /"),r.a.createElement("button",{onClick:se,className:"toggleEd"},"Ils ont regard\xe9 ton profil")),"visits"===a.cat&&!x&&r.a.createElement("div",{className:"lineToggle"},r.a.createElement("button",{onClick:se,className:"toggleEd"}," Tu as regard\xe9 leur profil /"),r.a.createElement("h3",null," Ils ont regard\xe9 ton profil")),"likes"===a.cat&&I&&r.a.createElement("div",{className:"lineToggle"},r.a.createElement("h3",null,"Tu as lik\xe9 leur profil /"),r.a.createElement("button",{onClick:ue,className:"toggleEd"},"Ils ont lik\xe9 ton profil")),"likes"===a.cat&&!I&&r.a.createElement("div",{className:"lineToggle"},r.a.createElement("button",{onClick:ue,className:"toggleEd"},"Tu as lik\xe9 leur profil /"),r.a.createElement("h3",null," Ils ont lik\xe9 ton profil ")),r.a.createElement("ul",{className:"listOthers"},J&&J.map(function(e,t){return r.a.createElement("li",{className:"others",key:t,value:e.id_user,onClick:function(){return function(e){d(e),document.getElementById("modal").style.display="block",a.visits.find(function(e){return e.id_visited===e.id_user})||(o.emit("notif",{type:"visit",id_visited:e.id_user,id_visitor:l.id_session}),o.on("visitInserted",function(t){c({type:"NEW_VISIT",payload:[].concat(Object(C.a)(a.visits),[{id_visit:t,id_visited:e.id_user,id_visitor:l.id_session}])})}))}(e)}},r.a.createElement("img",{src:Z(e),alt:"profilpic"+e.id_user}),r.a.createElement("div",{className:"othersInfos"}," ",r.a.createElement(j.a,{icon:y.h,style:{color:le.includes(e.id_user)?"green":"grey"}})," ",e.username,r.a.createElement("br",null),e.age," ans, ",e.city))})),10*(B+1)<b.length&&r.a.createElement(j.a,{className:"getDown",icon:y.a,onClick:function(){return q(B+1)}}),r.a.createElement("div",{id:"modal",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{className:"close",onClick:function(){document.getElementById("modal").style.display="none"}},"\xd7"),r.a.createElement("div",{className:"profilOther"},r.a.createElement("div",{className:"profil-img"},r.a.createElement("div",{className:"imgP"},r.a.createElement("h3",null,m.username," ",le.includes(m.id_user)?"En ligne":"Derni\xe8re connexion le : ".concat(function(e){e&&(e=new Date(e),e="".concat(e.getDate(),"/").concat(e.getMonth()+1," \xe0 ").concat(e.getHours(),"h").concat(e.getMinutes()));return e}(m.lastco))," "),m.imgs&&m.imgs.map(function(e,t){return r.a.createElement("img",{src:e.path,alt:"profilpic"+t,key:t})})),r.a.createElement("div",null,a.visits&&a.visits.find(function(e){return e.id_visitor===m.id_user})&&r.a.createElement("p",null,r.a.createElement(j.a,{icon:y.l,className:"interactionIcon"})," ",m.username," t'a d\xe9j\xe0 visit\xe9"),a.likes.find(function(e){return e.id_author===m.id_user})&&r.a.createElement("p",null,r.a.createElement(j.a,{icon:y.m,className:"interactionIcon"}),m.username," t'a d\xe9j\xe0 lik\xe9"),r.a.createElement("p",null,"Son score: ",m.popular)),r.a.createElement("div",null,r.a.createElement("h3",null,"Mes centres d'int\xe9r\xeats: "),r.a.createElement("ul",{className:"tags"},m.interest&&m.interest.map(function(e,t){return r.a.createElement("li",{key:t},e)})))),r.a.createElement("div",{className:"profil-info"},r.a.createElement("div",null,r.a.createElement("h3",null,m.firstname," ",m.lastname,", ",m.age," ans"),r.a.createElement("p",null,"Ma courte description :",r.a.createElement("br",null)," ",m.bio),"confirmed"===m.status?r.a.createElement("p",null,"Statut: confirm\xe9"):r.a.createElement("p",null,"Statut: report\xe9 comme faux profil")),r.a.createElement("div",null,r.a.createElement("h3",null,"Quelques informations personnelles: "),"female"===m.gender&&r.a.createElement("p",null,"Je suis : une femme "),"male"===m.gender&&r.a.createElement("p",null,"Je suis : un homme "),"other"===m.gender&&r.a.createElement("p",null,"Je suis : autre "),"female"===m.sexpref&&r.a.createElement("p",null,"Je recherche: une femme "),"male"===m.sexpref&&r.a.createElement("p",null,"Je recherche: un homme"),"bi"===m.sexpref&&r.a.createElement("p",null,"Je recherche: un homme ou une femme "),"other"===m.sexpref&&r.a.createElement("p",null,"Je recherche: autre "),r.a.createElement("p",null,"Je viens de : ",m.city)),m.imgs&&m.imgs.length>0&&"/public/img/avatar.png"!==l.img&&r.a.createElement("div",{className:"likeDiv"},r.a.createElement("h3",null,r.a.createElement("span",{style:{color:"red"}},"Like")," OU ",r.a.createElement("span",{style:{color:"green"}},"Unlike")),r.a.createElement(j.a,{icon:y.m,onClick:function(){var e=a.likes.findIndex(function(e){return e.id_liked===m.id_user&&e.id_author===l.id_session});if(-1===e)-1===a.likes.findIndex(function(e){return e.id_author===m.id_user})?(o.emit("notif",{type:"like",id_liked:m.id_user,id_author:l.id_session}),o.on("likeInserted",function(e){c({type:"NEW_LIKE",payload:[].concat(Object(C.a)(a.likes),[{id_like:e,id_liked:m.id_user,id_author:l.id_session}])})})):o.emit("notif",{type:"match",id_liked:m.id_user,id_author:l.id_session});else{var t=a.likes[e],n=a.matchs.findIndex(function(e){return e.id_user1===t.id_liked||e.id_user2===t.id_liked}),r=a.likes.filter(function(e){return e.id_liked!==t.id_liked}),i=Object(C.a)(a.matchs);n>-1?(i=a.matchs.filter(function(e){return e.id_user1!==t.id_liked&&e.id_user2!==t.id_liked}),o.emit("notif",{type:"unlike",id_like:t.id_like,id_author:t.id_author,id_liked:t.id_liked,delete:a.matchs[n].id_match})):o.emit("notif",{type:"unlike",id_like:t.id_like,id_author:t.id_author,id_liked:t.id_liked}),c({type:"NEW_UNLIKE",likes:r,matchs:i})}},className:"likeButton",style:{color:a.likes.find(function(e){return e.id_liked===m.id_user})?"red":"green"}})),r.a.createElement("div",{className:"likeDiv"},r.a.createElement("h3",null,"Un probl\xe8me avec ",m.username),r.a.createElement(j.a,{onClick:oe,className:"reportIcon",icon:y.k}),r.a.createElement("div",{id:"report"},r.a.createElement("ul",null,"fake"!==m.status&&r.a.createElement("li",{value:m.id_user,onClick:function(){var e=m.id_user;try{g.a.post("/user/others/fake",{id_other:e,id:l.id_session,token:l.token}),document.getElementById("modal").style.display="none";var t=Object(C.a)(b),a=t.findIndex(function(t){return t.id_user===e});a>-1&&(t[a].status="fake",O(t))}catch(n){ne("Une erreur est survenue.")}oe()}},"Reporter comme faux compte"),r.a.createElement("li",{value:m.id_user,onClick:function(){return me.apply(this,arguments)}},"Bloquer ce compte")))))))))),r.a.createElement("div",{className:"map"},r.a.createElement(G,{others:J,coord:[a.lat,a.lon]})))}function Z(e){var t=e.imgs.filter(function(e){return 1===e.profil}),a="/public/img/avatar.png";return t[0]&&(a=t[0].path),a}function Q(e){return e*Math.PI/180}function $(e,t,a,n){var r=Q(a-e),c=Q(n-t);e=Q(e),a=Q(a);var l=Math.sin(r/2)*Math.sin(r/2)+Math.sin(c/2)*Math.sin(c/2)*Math.cos(e)*Math.cos(a);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}function X(e,t,a,n){return n?t.filter(function(t){return e.filter(function(e){return e.id_visitor===a}).map(function(e){return e.id_visited}).includes(t.id_user)}):t.filter(function(t){return e.filter(function(e){return e.id_visited===a}).map(function(e){return e.id_visitor}).includes(t.id_user)})}function Y(e,t,a,n){if("age"===t)!0===n?e.sort(function(e,t){return e.age>t.age?1:-1}):e.sort(function(e,t){return e.age<t.age?1:-1});else if("localisation"===t)!0===n?e.sort(function(e,t){return $(e.latitude,e.longitude,a.lat,a.lon)>$(t.latitude,t.longitude,a.lat,a.lon)?1:-1}):e.sort(function(e,t){return $(e.latitude,e.longitude,a.lat,a.lon)<$(t.latitude,t.longitude,a.lat,a.lon)?1:-1});else if("popular"===t)!0===n?e.sort(function(e,t){return e.popular>t.popular?1:-1}):e.sort(function(e,t){return e.popular<t.popular?1:-1});else if("tags"===t){var r=Object(C.a)(a.defaultTags);r=r.map(function(e){return e.name_interest}),!0===n?e.sort(function(e,t){return ee(e.interest,r)<ee(t.interest,r)?1:-1}):e.sort(function(e,t){return ee(e.interest,r)>ee(t.interest,r)?1:-1})}return e}function ee(e,t){for(var a=0,n=0;n<e.length;n++)t.includes(e[n])&&(a+=1);return a}a(80),a(163);a(164);var te="NEW_GAME";function ae(e){var t=e.imgs.filter(function(e){return 1===e.profil}),a="/public/img/avatar.png";return t[0]&&(a=t[0].path),a}function ne(e){return e*Math.PI/180}function re(e){return e>0?e:-e}var ce=function(){var e=Object(n.useContext)(m),t=e.state,a=e.dispatch;return t.login&&a({type:"LOGOUT"}),Object(k.c)("/"),null};function le(){var e=Object(n.useContext)(m),t=e.state,a=e.dispatch,c=Object(n.useRef)(null),l=Object(n.useState)([]),s=Object(i.a)(l,2),u=s[0],o=s[1],d=Object(n.useState)(null),p=Object(i.a)(d,2),E=p[0],h=p[1],b=Object(n.useCallback)(k);function O(e){var a=new FormData;function n(){return(n=Object(v.a)(f.a.mark(function e(){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.post("/upload/img/".concat(t.id_session),a);case 3:(n=e.sent).data.error?h(n.data.error||"Une erreur est survenue."):o([].concat(Object(C.a)(u),[n.data])),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),h("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}a.append("file",e),a.append("token",t.token),a.append("id",t.id_session),function(){n.apply(this,arguments)}()}function k(e){return _.apply(this,arguments)}function _(){return(_=Object(v.a)(f.a.mark(function e(n){var r,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.findIndex(function(e){return e.id_img===n}),u[r].profil){e.next=12;break}return e.prev=2,e.next=5,g.a.post("/user/img/profil/switch",{id:t.id_session,id_img:n,token:t.token});case 5:e.sent.data?(c=u.findIndex(function(e){return 1===e.profil}),u[r].profil=1,c>-1&&(u[c].profil=0),a({type:"CHANGE_AVATAR",payload:u[r].path}),o(Object(C.a)(u))):h("Une erreur est survenue."),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),h("Une erreur est survenue.");case 12:case"end":return e.stop()}},e,null,[[2,9]])}))).apply(this,arguments)}return Object(n.useEffect)(function(){function e(){return(e=Object(v.a)(f.a.mark(function e(){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("/user/img/".concat(t.id_session));case 3:(a=e.sent).data?o(a.data):h("Une erreur est survenue."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),h("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t.id_session,E]),Object(n.useEffect)(function(){u.length>0&&u.every(function(e){return 0===e.profil})&&b(u[0].id_img)},[u,b]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"image-box-title"},"Mes photos:"),r.a.createElement("ul",{className:"listImg"},u.map(function(e,n){return r.a.createElement("li",{className:"listImgProfil",key:n},r.a.createElement("img",{className:e.profil?"user-img profilImg":"user-img",src:e.path,alt:"userImage"+n}),r.a.createElement("div",{className:"overlay",id:e.id_img},r.a.createElement(j.a,{icon:y.r,className:"favourite",onClick:function(){return k(e.id_img)}}),r.a.createElement("span",{className:"tooltip"},"Mettre en profil"),r.a.createElement(j.a,{icon:y.q,className:"delete",onClick:function(){return function(e){var n=u.findIndex(function(t){return t.id_img===e});u[n]&&(1===u[n].profil&&1===u.length&&a({type:"CHANGE_AVATAR",payload:"/public/img/avatar.png"}),g.a.post("/user/img/delete",{id_img:e,path:u[n].path,id:t.id_session,token:t.token}),o(u.filter(function(t){return t.id_img!==e})))}(e.id_img)}}),r.a.createElement("span",{className:"tooltip"},"Supprimer")))}),u.length<5&&r.a.createElement("div",{id:"drag",className:"user-img",onDrop:function(e){e.preventDefault(),document.getElementById("drag").style.border="3px dashed black",O(e.dataTransfer.files[0])},onDragOver:function(e){e.preventDefault(),document.getElementById("drag").style.border="3px dashed green"},onDragLeave:function(e){e.preventDefault(),document.getElementById("drag").style.border="3px dashed black"}},r.a.createElement("label",{htmlFor:"img"},"Cliquez ou d\xe9posez vos images ici",r.a.createElement("br",null),"(5/max, 1mo max, .jpeg, .jpg, .png)",r.a.createElement("input",{type:"file",ref:c,id:"img",onChange:function(){var e=c.current.files[0];e&&(e.size>1e6?h("L'image est sup\xe9rieur \xe0 1mo"):e.type.match(/image\/?(png)|(jpg)|(jpeg)/)?u.length>4?h("5 images maximum"):(E&&h(null),O(e),c.current.value=""):h("L'image ne poss\xe8de pas le bon format"))},accept:"image/jpeg, image/jpg, image/png",style:{display:"none"}}),E&&r.a.createElement("p",{className:"error"},E)))))}a(53);var ie="PROFIL";function se(e){var t=Object(n.useContext)(m),a=t.state,c=t.dispatch,l=e.info;return Object(n.useEffect)(function(){!a.profil&&l.bio&&l.city&&"/public/img/avatar.png"!==a.img&&""!==a.img&&l.tags.length>0?c({type:ie,profil:!0}):a.profil&&(l.bio&&l.city&&"/public/img/avatar.png"!==a.img&&""!==a.img&&0!==l.tags.length||c({type:ie,profil:!1}))},[a,l,c]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"- R\xe9sum\xe9 de ton profil -"),r.a.createElement("div",{className:"profil"},!a.profil&&r.a.createElement("p",{className:"paraInfo"},"Remplis tes infos publiques et ajoute au moins une photo pour pouvoir JOUER"),r.a.createElement("div",null,r.a.createElement("h3",null,l.firstname," ",l.lastname,", ",l.defaultAge," ans"),r.a.createElement("p",null,"Ma courte description :",r.a.createElement("br",null)," ",l.bio)),r.a.createElement("div",null,r.a.createElement("h3",null,"Quelques informations personnelles: "),r.a.createElement("p",null,"Tu es : ",function(e){if("female"===e)return"une femme";if("male"===e)return"un homme";if("other"===e)return"une personne non d\xe9finie, autre"}(l.gender)),r.a.createElement("p",null,"Tu recherches : ",function(e){if("female"===e)return"une femme";if("male"===e)return"un homme";if("bi"===e)return"un homme ou une femme";if("other"===e)return"une personne non d\xe9finie, autre"}(l.sexpref)),r.a.createElement("p",null,"Tu viens de : ",l.city)),r.a.createElement("div",null,r.a.createElement("h3",null,"Tes centres d'int\xe9r\xeats : "),r.a.createElement("ul",{className:"tags"},l.defaultTags.map(function(e,t){return r.a.createElement("li",{key:t},"#",e.name_interest)}))),r.a.createElement("div",null,"Ton score de popularit\xe9 : ",l.defaultPopular)),r.a.createElement(le,null))}var ue="CHANGE_CIVIL";function oe(e){var t=Object(i.a)(e.id,2),a=t[0],c=t[1],l=Object(i.a)(e.info,2),s=l[0],u=l[1],o=me(s.lastname),m=me(s.firstname),d=me(s.gender),p=Object(n.useState)(null),E=Object(i.a)(p,2),h=E[0],b=E[1];function O(){return(O=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,e.next=3,g.a.post("registration/lastname",{value:a});case 3:(n=e.sent).data.error?b(n.data.error+" -> Nom"):!n.data.error&&h&&b(null);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(){return(k=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,e.next=3,g.a.post("registration/firstname",{value:a});case 3:(n=e.sent).data.error?b(n.data.error+" -> Prenom"):!n.data.error&&h&&b(null);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(){return(j=Object(v.a)(f.a.mark(function t(n){var r;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),h){t.next=12;break}return t.prev=2,t.next=5,g.a.post("/user/editCivil",{lastname:o.value,firstname:m.value,gender:d.value,id:a,token:c});case 5:"ok"===(r=t.sent).data?(u({type:ue,lastname:o.value.toUpperCase(),firstname:m.value,gender:d.value}),e.show("")):b(r.data),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),b("Une erreur est survenue");case 12:case"end":return t.stop()}},t,null,[[2,9]])}))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"- Tes informations personnelles -"),r.a.createElement("div",{className:"profil"},h&&r.a.createElement("div",{className:"error"},h),r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return j.apply(this,arguments)}},r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Ton nom: "),r.a.createElement("input",Object.assign({type:"text"},o,{onBlur:function(e){return O.apply(this,arguments)}}))),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Ton pr\xe9nom: "),r.a.createElement("input",Object.assign({type:"text"},m,{onBlur:function(e){return k.apply(this,arguments)}}))),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Ta date de naissance:"),r.a.createElement("input",{type:"text",value:s.birthdate,disabled:!0})),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Tu es: "),r.a.createElement("select",d,r.a.createElement("option",{value:"male"},"un homme"),r.a.createElement("option",{value:"female"},"une femme"),r.a.createElement("option",{value:"other"},"autre"))),r.a.createElement("input",{className:"send",type:"submit",value:"Modifier"}))))}function me(e){var t=Object(n.useState)(e),a=Object(i.a)(t,2),r=a[0],c=a[1];return{value:r,onChange:function(e){c(e.target.value)}}}var de="CHANGE_TAGS";function pe(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],l=a[1],s=Object(i.a)(e.search,2),u=s[0],o=s[1],m=Object(n.useState)(null),d=Object(i.a)(m,2),p=d[0],E=d[1],h=Object(i.a)(e.id,2),b=h[0],O=h[1],k=Object(n.useState)(""),j=Object(i.a)(k,2),y=j[0],_=j[1];function x(){return(x=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=parseInt(t.target.value,10),e.prev=1,e.next=4,g.a.post("/interest/add",{id:b,interest:a,token:O});case 4:e.sent.data?(n=c.find(function(e){return e.id_interest===a}),o({type:de,tags:[].concat(Object(C.a)(u.defaultTags),[n])})):E("Une erreur est survenue."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),E("Une erreur est survenue.");case 11:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function N(){return(N=Object(v.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.post("/interest/delete",{id:b,interest:t.id_interest,token:O});case 3:e.sent.data?o({type:de,tags:u.defaultTags.filter(function(e){return e!==t})}):E("Une erreur est survenue."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),E("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function S(){return(S=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(/^[a-z]+$/.test(y)&&y.length<50)){e.next=18;break}if(c.find(function(e){return e.name_interest===y})||u.defaultTags.find(function(e){return e.name_interest===y})){e.next=15;break}return e.prev=3,e.next=6,g.a.post("/interest/addNewTag",{newTag:y,id:b,token:O});case 6:(a=e.sent).data?(o({type:de,tags:[].concat(Object(C.a)(u.defaultTags),[{id_interest:a.data.id,name_interest:y.toLowerCase()}])}),_("")):E("Une erreur est survenue."),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),E("Une erreur est survenue.");case 13:e.next=16;break;case 15:E("Ce tag existe d\xe9j\xe0.");case 16:e.next=19;break;case 18:E("Seuls les minuscules sont autoris\xe9es (50lettres max).");case 19:case"end":return e.stop()}},e,null,[[3,10]])}))).apply(this,arguments)}return Object(n.useEffect)(function(){function e(){return(e=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("/interest");case 3:(a=e.sent).data&&u.defaultTags.length>0?l(a.data.filter(function(e){return!u.defaultTags.find(function(t){return t.id_interest===e.id_interest})})):a.data?l(a.data):E("Une erreur est survenue."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),E("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}!function(t){e.apply(this,arguments)}(b)},[b,u.defaultTags]),r.a.createElement("div",{className:"profil"},p&&r.a.createElement("p",null,p),r.a.createElement("div",{className:"selectInterest"},r.a.createElement("div",{className:"divInterest"},r.a.createElement("p",{className:"paraInfo"}," S\xe9lectionne un tag ou cr\xe9e le "),r.a.createElement("p",{className:"paraInfo"}," Clique sur 'OK' pour revenir au r\xe9sum\xe9 de ton profil"),r.a.createElement("select",{value:"",onChange:function(e){return x.apply(this,arguments)}},r.a.createElement("option",null," -- S\xe9lectionne un # -- "),c.map(function(e,t){return r.a.createElement("option",{value:e.id_interest,key:t},e.name_interest)}))),r.a.createElement("div",{className:"divInterest"},r.a.createElement("label",null,"Ou cr\xe9er ton propre TAG:"),r.a.createElement("input",{type:"text",onChange:function(e){_(e.target.value)},value:y}),r.a.createElement("button",{className:"buttonsend",onClick:function(e){return S.apply(this,arguments)}},"Ajouter"))),r.a.createElement("div",{className:"selectInterest"},r.a.createElement("ul",{className:"tags"},u.defaultTags.map(function(e,t){return r.a.createElement("li",{key:t,onClick:function(){return function(e){return N.apply(this,arguments)}(e)}},"#",e.name_interest)}))),r.a.createElement("button",{className:"buttonsend",onClick:function(){return e.show("")}},"OK"))}var fe="CHANGE_PUBLIC";function ve(e){var t=Object(i.a)(e.id,2),a=t[0],c=t[1],l=Object(i.a)(e.info,2),s=l[0],u=l[1],o=Ee(s.sexpref),m=Ee(s.bio),d=Object(n.useState)(s.city),p=Object(i.a)(d,2),E=p[0],h=p[1],b=Object(n.useState)(""),O=Object(i.a)(b,2),k=O[0],j=O[1],y=Object(n.useState)(null),_=Object(i.a)(y,2),x=_[0],N=_[1],C=Object(n.useState)(!1),S=Object(i.a)(C,2),w=S[0],I=S[1],M=Object(n.useState)([0,0]),T=Object(i.a)(M,2),A=T[0],U=T[1];function L(){return(L=Object(v.a)(f.a.mark(function t(n){var r,l,s,d,p,v;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),0===A[0]||0===A[1]){t.next=7;break}s=Object(i.a)(A,2),r=s[0],l=s[1],t.next=13;break;case 7:return t.next=9,ge(E);case 9:d=t.sent,p=Object(i.a)(d,2),r=p[0],l=p[1];case 13:return t.next=15,g.a.post("/user/editInfo",{sexpref:o.value,bio:m.value,id:a,token:c,lat:r,lon:l,city:E});case 15:"ok"===(v=t.sent).data?(u({type:fe,sexpref:o.value,bio:m.value,city:E,lat:r,lon:l}),e.show("")):N(v.data);case 17:case"end":return t.stop()}},t)}))).apply(this,arguments)}function F(){return(F=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(t.target.value),e.prev=1,e.next=4,g.a.get("https://geo.api.gouv.fr/communes?nom="+t.target.value);case 4:a=e.sent,j(a.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),N("Une erreur est survenue lors du chargement des villes");case 11:document.getElementsByClassName("suggCity")[0].style.display="block";case 12:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function D(e){h(e.target.id),document.getElementsByClassName("suggCity")[0].style.display="none"}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"- Tes informations pour matcher -"),x&&r.a.createElement("div",{className:"error"},x),r.a.createElement("div",{className:"profil"},r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return L.apply(this,arguments)}},r.a.createElement("p",{className:"paraInfo"}," Remplis ta recherche, \xe9cris ta bio enfin clique pour \xeatre g\xe9olocalis\xe9 OU remplis ta ville "),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Tu recherches: "),r.a.createElement("select",o,r.a.createElement("option",{value:"bi"},"Une femme ou un homme"),r.a.createElement("option",{value:"male"},"Un homme"),r.a.createElement("option",{value:"female"},"Une femme"),r.a.createElement("option",{value:"other"},"autre"))),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Ta courte description: "),r.a.createElement("textarea",Object.assign({type:"text"},m,{maxLength:"160"}))),r.a.createElement("button",{id:"locCity",onClick:function(e){function t(){return(t=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.coords,e.next=3,be(a.latitude,a.longitude);case 3:n=e.sent,h(n),U([a.latitude,a.longitude]),I(!1);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}e.preventDefault(),I(!0),navigator.geolocation.getCurrentPosition(function(e){return t.apply(this,arguments)},function(e){N("Veuillez autoriser le navigateur \xe0 vous localiser"),I(!1)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}},"Geolocalise moi")," ",w&&"Loading...",r.a.createElement("div",{className:"divForm city"},r.a.createElement("label",null,"Ta ville: "),r.a.createElement("input",{className:"city",type:"text",value:E,onChange:function(e){return F.apply(this,arguments)}}),r.a.createElement("ul",{className:"suggCity"},k&&k.map(function(e,t){return r.a.createElement("li",{key:t,id:e.nom,onClick:D},e.nom)}))),r.a.createElement("input",{className:"send",type:"submit",value:"Enregistrer"}))),r.a.createElement(pe,{id:e.id,search:[s,u],show:e.show}))}function Ee(e){var t=Object(n.useState)(e),a=Object(i.a)(t,2),r=a[0],c=a[1];return{value:r,onChange:function(e){c(e.target.value)}}}function ge(e){return he.apply(this,arguments)}function he(){return(he=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("https://nominatim.openstreetmap.org/search?q=".concat(t,"&format=json&addressdetails=1"));case 3:if(!(a=e.sent).data[0]||"France"!==a.data[0].address.country){e.next=8;break}return e.abrupt("return",[a.data[0].lat,a.data[0].lon]);case 8:return e.abrupt("return",[0,0]);case 9:e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",[0,0]);case 14:case"end":return e.stop()}},e,null,[[0,11]])}))).apply(this,arguments)}function be(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(v.a)(f.a.mark(function e(t,a){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(t,"&lon=").concat(a,"&addressdetails=1"));case 3:return n=e.sent,e.abrupt("return",n.data.address.city);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return","");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function ke(e){var t=je(""),a=je(""),c=Object(n.useState)(null),l=Object(i.a)(c,2),s=l[0],u=l[1];function o(){return(o=Object(v.a)(f.a.mark(function a(n){var r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.prev=1,a.next=4,g.a.post("/editpass",{password:t.value,token:e.token});case 4:"ok"!==(r=a.sent).data||e.login||Object(k.c)("/connexion"),"ok"===r.data&&e.login?e.show(""):u("Le changement de mot de passe n'est pas effectif"),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),u("Une erreur est survenue.");case 12:case"end":return a.stop()}},a,null,[[1,9]])}))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,s&&r.a.createElement("div",null,s),r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return o.apply(this,arguments)}},r.a.createElement(ye,{val:t,className:"divForm"}),r.a.createElement(_e,{val:a,pwd:t.value,className:"divForm"}),r.a.createElement("input",{className:"send",type:"submit",value:"Valider"})))}function je(e){var t=Object(n.useState)(e),a=Object(i.a)(t,2),r=a[0],c=a[1];return{value:r,onChange:function(e){c(e.target.value)}}}function ye(e){var t=function(e,t){var a=Object(n.useState)(""),r=Object(i.a)(a,2),c=r[0],l=r[1];return Object(n.useEffect)(function(){var a=document.getElementsByTagName("input")[t];function n(e){return r.apply(this,arguments)}function r(){return(r=Object(v.a)(f.a.mark(function a(n){var r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.a.post("/registration/".concat(t),{value:e});case 3:(r=a.sent).data.error?l(r.data.error):l("OK"),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),l("Une erreur est survenue.");case 10:case"end":return a.stop()}},a,null,[[0,7]])}))).apply(this,arguments)}return a.addEventListener("blur",n),function(){a.removeEventListener("blur",n)}}),c}(e.val.value,"password");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Mot de passe:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"})),r.a.createElement("input",Object.assign({type:"password",name:"password",placeholder:"matcha"},e.val,{required:!0}))),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t))}function _e(e){var t=e.val,a=e.pwd,c=Object(n.useState)(""),l=Object(i.a)(c,2),s=l[0],u=l[1];return Object(n.useEffect)(function(){var e=document.getElementsByTagName("input").cfpassword;function n(e){return r.apply(this,arguments)}function r(){return(r=Object(v.a)(f.a.mark(function e(n){var r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.post("/registration/cfpassword",{cfpassword:t.value,password:a});case 3:(r=e.sent).data.error?u(r.data.error):u("OK"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return e.addEventListener("blur",n),function(){e.removeEventListener("blur",n)}}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Confirmation:","OK"===s&&r.a.createElement(j.a,{icon:y.e,color:"green"})),r.a.createElement("input",Object.assign({type:"password",name:"cfpassword",placeholder:"matcha"},t,{required:!0}))),s&&"OK"!==s&&r.a.createElement("span",{className:"error"},s))}var xe="CHANGE_MAIL";function Ne(e){var t=Object(i.a)(e.info,2),a=t[0],c=t[1],l=Object(n.useState)(a.mail),s=Object(i.a)(l,2),u=s[0],o=s[1],m=Object(n.useState)(""),d=Object(i.a)(m,2),p=d[0],E=d[1];function h(){return(h=Object(v.a)(f.a.mark(function t(a){var n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,g.a.post("registration/email",{value:u});case 4:if(!(n=t.sent).data.error){t.next=9;break}E(n.data.error),t.next=13;break;case 9:return t.next=11,g.a.post("user/editMail",{mail:u,id:e.state.id_session,token:e.state.token});case 11:"ok"===(n=t.sent).data?(c({type:xe,mail:u}),e.show("")):E(n.data);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),E("Une erreur est survenue.");case 18:case"end":return t.stop()}},t,null,[[1,15]])}))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"- Modifie tes informations de connexion -"),p&&r.a.createElement("div",{className:"error"},p),r.a.createElement("div",{className:"profil"},r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return h.apply(this,arguments)}},r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Ton mail: "),r.a.createElement("input",{type:"text",value:u,onChange:function(e){o(e.target.value)}})),r.a.createElement("input",{type:"submit",className:"send",value:"Modifier l'email"})),r.a.createElement(ke,{token:e.state.token,show:e.show,login:e.state.login})))}function Ce(e){var t=Object(i.a)(e.id,2),a=t[0],c=t[1],l=Object(i.a)(e.info,2),s=l[0],u=l[1],o=Object(n.useState)([]),m=Object(i.a)(o,2),d=m[0],p=m[1],E=Object(n.useState)(null),h=Object(i.a)(E,2),b=h[0],O=h[1];function k(){return(k=Object(v.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.post("/user/others/deblock",{id_blocked:t,id_author:a,id:a,token:c});case 3:"OK"===e.sent.data?u({type:"NEW_BLOCK",payload:s.blocks.filter(function(e){return e.id_blocked!==t})}):O("Une erreur est survenue."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),O("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return Object(n.useEffect)(function(){function e(){return(e=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("/user/others/blocked/".concat(t));case 2:(a=e.sent).data?p(a.data):O("Une erreur est survenue.");case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}if(s.blocks.length>0){var t=s.blocks.filter(function(e){return e.id_blocked!==a}).map(function(e){return e.id_blocked}).join(",");""!==t&&function(t){e.apply(this,arguments)}(t)}else p([])},[s.blocks,a]),r.a.createElement("div",{className:"blocked"},r.a.createElement("h2",null,"- Les utilisateurs que tu bloques -"),b&&r.a.createElement("p",null,b),r.a.createElement("ul",{className:"blocked-wrap"},d&&d.map(function(e,t){return r.a.createElement("li",{className:"blockedUser",key:t},r.a.createElement("img",{src:e.img,alt:"profilpic"+e.id_user}),r.a.createElement("br",null),e.username,r.a.createElement("br",null),e.city,r.a.createElement("br",null),r.a.createElement("button",{className:"deblock",onClick:function(){return function(e){return k.apply(this,arguments)}(e.id_user)}},"D\xe9bloquer l'utilisateur"))})))}a(165);function Se(e){var t=[e.state.id_session,e.state.token],a=Object(n.useContext)(h),c=a.search,l=a.dispatchSearch,s=Object(n.useState)(""),u=Object(i.a)(s,2),o=u[0],m=u[1];function d(e){m(e)}return r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"sideContainer"},r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(){return d("")},className:""===o?"currentInfo":""},"R\xe9sum\xe9"),r.a.createElement("li",{onClick:function(){return d("civil")},className:"civil"===o?"currentInfo":""},"Infos civiles"),r.a.createElement("li",{onClick:function(){return d("info")},className:"info"===o?"currentInfo":""},"Infos publiques"),r.a.createElement("li",{onClick:function(){return d("account")},className:"account"===o?"currentInfo":""},"Informations de connexion"),r.a.createElement("li",{onClick:function(){return d("block")},className:"block"===o?"currentInfo":""},"Utilisateurs bloqu\xe9s"))),r.a.createElement("div",{className:"container"},""===o&&r.a.createElement(se,{info:c}),"civil"===o&&r.a.createElement(oe,{id:t,info:[c,l],show:m}),"info"===o&&r.a.createElement(ve,{id:t,info:[c,l],show:m}),"account"===o&&r.a.createElement(Ne,{state:e.state,info:[c,l],show:m}),"block"===o&&r.a.createElement(Ce,{id:t,info:[c,l],show:m})))}a(166);function we(e){var t=Object(n.useState)(e),a=Object(i.a)(t,2),r=a[0],c=a[1];return{value:r,onChange:function(e){c(e.target.value)}}}function Ie(e,t){var a=Object(n.useState)(""),r=Object(i.a)(a,2),c=r[0],l=r[1];return Object(n.useEffect)(function(){var a=document.getElementsByTagName("input")[t];function n(e){return r.apply(this,arguments)}function r(){return(r=Object(v.a)(f.a.mark(function a(n){var r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.a.post("registration/".concat(t),{value:e});case 3:(r=a.sent).data.error?l(r.data.error):l("OK"),a.next=9;break;case 7:a.prev=7,a.t0=a.catch(0);case 9:case"end":return a.stop()}},a,null,[[0,7]])}))).apply(this,arguments)}return a.addEventListener("blur",n),function(){a.removeEventListener("blur",n)}}),c}function Me(e){return r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Tu es: "),r.a.createElement("select",Object.assign({},e.val,{required:!0}),r.a.createElement("option",{value:"male"},"Un homme"),r.a.createElement("option",{value:"female"},"Une femme"),r.a.createElement("option",{value:"other"},"Autre")))}function Te(e){var t=Ie(e.val.value,"date"),a=new Date,n=a.getFullYear(),c=a.getMonth();c=c.toString().padStart(2,"0");var l=a.getDate();return l=l.toString().padStart(2,"0"),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Date de naissance:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"}),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t)),r.a.createElement("input",Object.assign({type:"date",name:"date",max:"".concat(n-18,"-").concat(c,"-").concat(l),min:"".concat(n-80,"-").concat(c,"-").concat(l)},e.val,{required:!0})))}function Ae(e){var t=Ie(e.val.value,"lastname");return r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Nom:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"}),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t)),r.a.createElement("input",Object.assign({type:"text",name:"lastname",placeholder:"MAT"},e.val,{required:!0})))}function Ue(e){var t=Ie(e.val.value,"firstname");return r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Pr\xe9nom:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"}),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t)),r.a.createElement("input",Object.assign({type:"text",name:"firstname",placeholder:"Cha"},e.val,{required:!0})))}function Le(e){var t=Ie(e.val.value,"username");return r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Pseudo:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"}),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t)),r.a.createElement("input",Object.assign({type:"text",name:"username",placeholder:"Matchera"},e.val,{required:!0})))}function Fe(e){var t=Ie(e.val.value,"email");return r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Email:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"}),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t)),r.a.createElement("input",Object.assign({type:"email",name:"email",placeholder:"matcha@matcha.com"},e.val,{required:!0})))}function De(e){var t=Ie(e.val.value,"password");return r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Mot de passe:","OK"===t&&r.a.createElement(j.a,{icon:y.e,color:"green"}),t&&"OK"!==t&&r.a.createElement("span",{className:"error"},t)),r.a.createElement("input",Object.assign({type:"password",name:"password",placeholder:"matcha"},e.val,{required:!0})))}function Re(e){var t=e.val,a=e.pwd,c=Object(n.useState)(""),l=Object(i.a)(c,2),s=l[0],u=l[1];return Object(n.useEffect)(function(){var e=document.getElementsByTagName("input").cfpassword;function n(e){return r.apply(this,arguments)}function r(){return(r=Object(v.a)(f.a.mark(function e(n){var r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.post("registration/cfpassword",{cfpassword:t.value,password:a});case 3:(r=e.sent).data.error?u(r.data.error):u("OK"),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return e.addEventListener("blur",n),function(){e.removeEventListener("blur",n)}}),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Confirmation:","OK"===s&&r.a.createElement(j.a,{icon:y.e,color:"green"}),s&&"OK"!==s&&r.a.createElement("span",{className:"error"},s)),r.a.createElement("input",Object.assign({type:"password",name:"cfpassword",placeholder:"matcha"},t,{required:!0})))}l.a.render(r.a.createElement(function(e){var t=function(){try{var e=localStorage.getItem("store");return e?JSON.parse(e):void 0}catch(t){return}}();t?o.emit("login",t.id_session):t={login:!1,username:"",id_session:null,token:"",profil:!1,img:"/public/img/avatar.png"};var a=r.a.useReducer(d,t),n=Object(i.a)(a,2),c={state:n[0],dispatch:n[1]};return r.a.createElement(m.Provider,{value:c},e.children)},null,r.a.createElement(function(e){var t=r.a.useReducer(O,b),a=Object(i.a)(t,2),c=a[0],l=a[1],s={search:c,dispatchSearch:l},u=Object(n.useContext)(m).state;return Object(n.useEffect)(function(){var e=g.a.CancelToken.source();function t(){return(t=Object(v.a)(f.a.mark(function t(){var a,n,r,c,i,s,o;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.a.get("/user/findWithId/".concat(u.id_session),{cancelToken:e.token});case 3:return a=t.sent,n=a.data,t.next=7,g.a.get("/user/interactions/".concat(u.id_session),{cancelToken:e.token});case 7:a=t.sent,r=a.data,n&&r&&(c=n.age-5<18?18:n.age-5,i=n.age+5>80?80:n.age+5,s=n.popular-15<0?0:n.popular-15,o=n.popular+15>195?200:n.popular+15,l({type:"INIT",payload:{cat:"sugg",mail:n.mail,lastname:n.lastname,firstname:n.firstname,bio:n.bio,gender:n.gender,sexpref:n.sexpref,ageMin:c,ageMax:i,defaultAge:n.age,birthdate:n.birthdate,localMax:10,city:n.city,lat:n.latitude,lon:n.longitude,popularMin:s,popularMax:o,defaultPopular:n.popular,defaultTags:n.tags,tags:n.tags,visits:r.visits,likes:r.likes,matchs:r.matchs,blocks:r.blocks,filter:{sex:!0,age:!1,local:!1,popular:!1,tags:!1,search:{bool:!1}},loaded:!0,lastco:n.lastco}})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),g.a.isCancel(t.t0)&&e.cancel();case 15:case"end":return t.stop()}},t,null,[[0,12]])}))).apply(this,arguments)}return u.login&&function(){t.apply(this,arguments)}(),function(){e.cancel()}},[u.login,l,u.id_session]),r.a.createElement(h.Provider,{value:s},e.children)},null,r.a.createElement(k.b,null,r.a.createElement(function(e){var t=Object(n.useContext)(m).state,a=Object(n.useState)([]),c=Object(i.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)(null),o=Object(i.a)(u,2),d=o[0],p=o[1],E=Object(n.useState)(!0),h=Object(i.a)(E,2),b=h[0],O=h[1];return Object(n.useEffect)(function(){var e,a=g.a.CancelToken.source();function n(){return r.apply(this,arguments)}function r(){return(r=Object(v.a)(f.a.mark(function e(){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("/user/others/".concat(t.id_session),{cancelToken:a.token});case 3:(n=e.sent).data&&(s(n.data),O(!1)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g.a.isCancel(e.t0)?a.cancel():p("Une erreur est survenue.");case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return t.login&&(n(),e=setInterval(n,3e4)),function(){a.cancel(),e&&clearInterval(e)}},[t.login,t.id_session]),t.login?r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),d&&r.a.createElement("p",null,d),r.a.createElement(J,{others:l,state:t,loading:b})):r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("section",{className:"homeLogout"},d&&r.a.createElement("p",null,d),r.a.createElement("div",null,r.a.createElement("p",null,"Trouve ta moiti\xe9 - MATCHA -"))),r.a.createElement("div",{className:"home"},"-- Rejoins la communaut\xe9, Inscris toi --"),r.a.createElement(k.a,{to:"/inscription"},r.a.createElement("div",{id:"heart"})))},{path:"/"}),r.a.createElement(function(){var e=Object(n.useContext)(m).state,t=Object(n.useContext)(h),a=t.search,c=t.dispatchSearch,l=Object(n.useState)([]),u=Object(i.a)(l,2),d=u[0],p=u[1],E=Object(n.useState)([]),b=Object(i.a)(E,2),O=b[0],k=b[1],_=Object(n.useState)(0),x=Object(i.a)(_,2),S=x[0],w=x[1],I=Object(n.useState)(null),M=Object(i.a)(I,2),T=M[0],A=M[1],U=Object(n.useState)({age:!0,loc:!0,pop:!0,tags:!0}),L=Object(i.a)(U,2),D=L[0],R=L[1],H=Object(n.useState)(!0),P=Object(i.a)(H,2),K=P[0],B=P[1],q=Object(n.useState)(null),W=Object(i.a)(q,2),z=W[0],V=W[1];function J(e){"age"===e.target.name?R(Object(s.a)({},D,{age:e.target.checked})):"loc"===e.target.name?R(Object(s.a)({},D,{loc:e.target.checked})):"pop"===e.target.name?R(Object(s.a)({},D,{pop:e.target.checked})):"tags"===e.target.name&&R(Object(s.a)({},D,{tags:e.target.checked})),w(0)}return Object(n.useEffect)(function(){var t=g.a.CancelToken.source();function n(){return(n=Object(v.a)(f.a.mark(function a(){var n;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.a.get("/user/others/".concat(e.id_session),{cancelToken:t.token});case 3:(n=a.sent).data?V(n.data):A("Une erreur est survenue."),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),g.a.isCancel(a.t0)?t.cancel():A("Une erreur est survenue.");case 10:case"end":return a.stop()}},a,null,[[0,7]])}))).apply(this,arguments)}return e.login&&a.loaded&&function(){n.apply(this,arguments)}(),function(){t.cancel()}},[e.login,e.id_session,a.loaded]),Object(n.useEffect)(function(){if(z){var t=function(e,t){var a=[];return e.visits.forEach(function(e){e.id_visitor===t||a.includes(e.id_visitor)||a.push(e.id_visitor),e.id_visited===t||a.includes(e.id_visited)||a.push(e.id_visited)}),e.likes.forEach(function(e){e.id_liked===t||a.includes(e.id_liked)||a.push(e.id_liked),e.id_author===t||a.includes(e.id_author)||a.push(e.id_author)}),e.blocks.forEach(function(e){e.id_blocked===t||a.includes(e.id_blocked)||a.push(e.id_blocked),e.id_author===t||a.includes(e.id_author)||a.push(e.id_author)}),e.matchs.forEach(function(e){e.id_user1===t||a.includes(e.id_user1)||a.push(e.id_user1),e.id_user2===t||a.includes(e.id_user2)||a.push(e.id_user2)}),a}(a,e.id_session),n=z.filter(function(e){return!t.includes(e.id_user)});B(!1),p(n)}},[a,e.id_session,z]),Object(n.useEffect)(function(){d.length>0&&k(function(e,t,a){return(t=(t=(t=t.filter(function(t){return"bi"===e.sexpref?"male"===t.gender||"female"===t.gender:t.gender===e.sexpref}).filter(function(t){return"male"===e.gender?"bi"===t.sexpref||"male"===t.sexpref:"female"===e.gender?"bi"===t.sexpref||"female"===t.sexpref:"other"===t.sexpref}).filter(function(e){return"confirmed"===e.status}).filter(function(e){return e.imgs.find(function(e){return e.profil})})).map(function(t){return t.score=function(e,t,a){var n=0,r=0;if(a.age?(r=re(e.defaultAge-t.age))<=10&&(n+=20-r):n+=20,a.loc?(r=function(e,t,a,n){var r=ne(a-e),c=ne(n-t);e=ne(e),a=ne(a);var l=Math.sin(r/2)*Math.sin(r/2)+Math.sin(c/2)*Math.sin(c/2)*Math.cos(e)*Math.cos(a),i=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return 6371*i}(e.lat,e.lon,t.latitude,t.longitude))<=50&&(n+=50-r):n+=50,a.pop){var c=re(e.defaultPopular-t.popular);c<=10&&(n+=10-c)}else n+=10;if(a.tags){var l=e.defaultTags.length;if(l>0){var i=function(e,t){for(var a=0,n=0;n<e.length;n++)t.includes(e[n])&&(a+=1);return a}(e.defaultTags.map(function(e){return e.name_interest}),t.interest);n+=i*(10/l)}else n+=10}else n+=10;return n+=2.5*(t.imgs.length-1)}(e,t,a),t})).filter(function(e){return e.score>50})).sort(function(e,t){return e.score<t.score?1:-1})}(a,d,D))},[a,d,D]),e.login?e.profil?r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("h2",{className:"gameTitle"},"-- La tisane parfaite --"),T&&r.a.createElement("p",null,T),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},K&&r.a.createElement("img",{className:"loader",src:"/public/img/ajax-loader.gif",alt:"loader"})),r.a.createElement("ul",{className:"filter-wrapper"},r.a.createElement("li",{className:"filter"},"Avec ou sans filtres :"),r.a.createElement("li",{className:"filter"},r.a.createElement("label",null,"Age",r.a.createElement("input",{type:"checkbox",name:"age",checked:D.age,onChange:J}))),r.a.createElement("li",{className:"filter"},r.a.createElement("label",null,"Localisation",r.a.createElement("input",{type:"checkbox",name:"loc",checked:D.loc,onChange:J}))),r.a.createElement("li",{className:"filter"},r.a.createElement("label",null,"Score de popularit\xe9",r.a.createElement("input",{type:"checkbox",name:"pop",checked:D.pop,onChange:J}))),r.a.createElement("li",{className:"filter"},r.a.createElement("label",null,"Tags en commun",r.a.createElement("input",{type:"checkbox",name:"tags",checked:D.tags,onChange:J})))),!O[S]&&r.a.createElement("p",null,"Vous n'avez aucune suggestion...Essayez de d\xe9sactiver les filtres"),O[S]&&r.a.createElement("div",{className:"suggMatch"},r.a.createElement("h3",null,O[S].username,", ",O[S].age," ans"),r.a.createElement("h4",null,O[S].score.toFixed(2)," % compatible"),r.a.createElement("div",{className:"switchWrapper"},0===S&&r.a.createElement(j.a,{className:"switchIconDis",icon:y.f}),S>0&&r.a.createElement(j.a,{className:"switchIcon",icon:y.f,onClick:function(){return w(S-1)}}),r.a.createElement("img",{src:ae(O[S]),alt:"profilpic"+O[S].id_user}),S<O.length-1&&r.a.createElement(j.a,{className:"switchIcon",icon:y.g,onClick:function(){return w(S+1)}}),S===O.length-1&&r.a.createElement(j.a,{className:"switchIconDis",icon:y.g})),r.a.createElement(j.a,{className:"love-button",icon:y.m,onClick:function(){return t=O[S],o.emit("notif",{type:"game",id_other:t.id_user,id_author:e.id_session}),void o.on("gameInserted",function(n){c({type:te,visits:[].concat(Object(C.a)(a.visits),[{id_visit:n.id_visit,id_visitor:e.id_session,id_visited:t.id_other}]),likes:[].concat(Object(C.a)(a.likes),[{id_like:n.id_like,id_liked:t.id_user,id_author:e.id_session}])}),w(0)});var t}}),r.a.createElement("div",{className:"suggInfo"},r.a.createElement("div",null,r.a.createElement("h3",null,O[S].firstname," ",O[S].lastname,", ",O[S].age," ans"),r.a.createElement("p",null,"Ma courte description :",r.a.createElement("br",null)," ",O[S].bio)),r.a.createElement("div",null,r.a.createElement("h3",null,"Quelques informations personnelles: "),r.a.createElement("p",null,"Je suis : ",(Z=O[S].gender,"female"===Z?"une femme":"male"===Z?"un homme":"other"===Z?"une personne non d\xe9finie, autre":void 0)),r.a.createElement("p",null,"Je recherche : ",function(e){return"female"===e?"une femme":"male"===e?"un homme":"bi"===e?"un homme ou une femme":"other"===e?"une personne non d\xe9finie, autre":void 0}(O[S].sexpref)),r.a.createElement("p",null,"De : ",O[S].city)),r.a.createElement("div",null,r.a.createElement("h3",null,"Mes centres d'int\xe9r\xeats: "),r.a.createElement("ul",{className:"tags"},O[S].interest&&O[S].interest.map(function(e,t){return r.a.createElement("li",{key:t},e)}))))),r.a.createElement("div",{className:"map"},r.a.createElement(G,{others:O,coord:[a.lat,a.lon],index:S}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("div",{className:"containLogin"},r.a.createElement("p",null,"Vous devez compl\xe9ter votre profil pour acc\xe9der aux suggestions."),r.a.createElement("p",null,"Ajoutez y une photo de profil, une description, quelques centres d'int\xe9r\xeats et votre ville."),r.a.createElement("p",null,"Nous nous chargerons du reste ;)"))):r.a.createElement(N,null);var Z},{path:"/jouer"}),r.a.createElement(function(){var e=Object(n.useContext)(m),t=e.state,a=e.dispatch,c=D(""),l=D(""),s=Object(n.useState)(null),u=Object(i.a)(s,2),o=u[0],d=u[1],p=Object(n.useState)({latitude:0,longitude:0}),E=Object(i.a)(p,2),h=E[0],b=E[1];function O(){return(O=Object(v.a)(f.a.mark(function e(t){var n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g.a.post("/login",{identity:c.value,password:l.value,lat:h.latitude,lon:h.longitude});case 4:n=e.sent,(r=n.data).id_user?(a({type:"LOGIN",id:r.id_user,username:r.username,token:r.token,img:r.img}),Object(k.c)("/")):d(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),d("Une erreur est survenue.");case 12:case"end":return e.stop()}},e,null,[[1,9]])}))).apply(this,arguments)}return Object(n.useEffect)(function(){function e(){return(e=Object(v.a)(f.a.mark(function e(){var t,a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("http://api.ipstack.com/check?access_key=".concat("014521e4206ec672ceac480bd61c983b"));case 3:t=e.sent,a=t.data.latitude,n=t.data.longitude,b({latitude:a,longitude:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),d("Une erreur est survenue.");case 12:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}var t=navigator.geolocation.watchPosition(function(e){var t=e.coords.latitude,a=e.coords.longitude;b({latitude:t,longitude:a})},function(t){t.code===t.PERMISSION_DENIED&&function(){e.apply(this,arguments)}()});return function(){navigator.geolocation.clearWatch(t)}},[]),t.login?r.a.createElement(N,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("div",{className:"containLogin"},o&&r.a.createElement("div",null,o),r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return O.apply(this,arguments)}},r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Pseudo ou mail: "),r.a.createElement("input",Object.assign({type:"text"},c))),r.a.createElement("div",{className:"divForm"},r.a.createElement("label",null,"Mot de passe: "),r.a.createElement("input",Object.assign({type:"password"},l))),r.a.createElement(k.a,{className:"sendForget",to:"/connexion/oublie"},"Mot de passe oublie"),r.a.createElement("input",{className:"send",type:"submit",value:"Se connecter"}))))},{path:"/connexion"}),r.a.createElement(ce,{path:"/deconnexion"}),r.a.createElement(function(){var e=we("male"),t=we(""),a=we(""),c=we(""),l=we(""),s=we(""),u=we(""),o=we(""),d=Object(n.useState)(null),p=Object(i.a)(d,2),E=p[0],g=p[1];function h(){return(h=Object(v.a)(f.a.mark(function n(r){var i,m;return f.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,n.next=4,fetch("/registration",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({gender:e.value,birthdate:t.value,lastname:a.value,firstname:c.value,username:l.value,email:s.value,password:u.value,cfpassword:o.value})});case 4:return i=n.sent,n.next=7,i.json();case 7:m=n.sent,0===Object.keys(m).length&&g(!0),n.next=13;break;case 11:n.prev=11,n.t0=n.catch(1);case 13:case"end":return n.stop()}},n,null,[[1,11]])}))).apply(this,arguments)}return Object(n.useContext)(m).state.login?r.a.createElement(N,null):E?r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("div",{className:"containLogin"},r.a.createElement("p",null,"Merci pour votre inscription. Il ne vous reste plus qu'\xe0 valider votre compte via le lien que nous vous avons envoy\xe9 sur votre adresse mail."))):r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return h.apply(this,arguments)},style:{boxShadow:"0px 0px 5px 5px #8EC83C"}},r.a.createElement(Me,{val:e}),r.a.createElement(Te,{val:t}),r.a.createElement(Ae,{val:a}),r.a.createElement(Ue,{val:c}),r.a.createElement(Le,{val:l}),r.a.createElement(Fe,{val:s}),r.a.createElement(De,{val:u}),r.a.createElement(Re,{val:o,pwd:u.value}),r.a.createElement("input",{className:"send",type:"submit",value:"Cr\xe9er un compte"})))},{path:"/inscription"}),r.a.createElement(function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(7),u=Object(i.a)(s,2),o=u[0],m=u[1];function d(){return(d=Object(v.a)(f.a.mark(function t(){var a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.get("/registration/activate/".concat(e.token));case 2:"OK"!==(a=t.sent).data&&l(a.data);case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}return Object(n.useEffect)(function(){var e=setInterval(function(){m(o-1)},1e3);return function(){clearInterval(e)}}),c||function(){d.apply(this,arguments)}(),0===o&&Object(k.c)("/connexion"),r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("div",{className:"containLogin"},c&&r.a.createElement("p",null,c),r.a.createElement("p",null,"Vous serez redirig\xe9 dans ",o,"...")))},{path:"/activate/:token"}),r.a.createElement(function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],c=t[1],l=D("");function s(){return(s=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g.a.post("/forgotpass",{identity:l.value});case 4:"send"===(a=e.sent).data?Object(k.c)("/"):c(a.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),c("Une erreur est survenue.");case 11:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),a&&r.a.createElement("div",null,a),r.a.createElement("div",{className:"containLogin"},r.a.createElement("form",{className:"formInfo",onSubmit:function(e){return s.apply(this,arguments)}},r.a.createElement("div",null,r.a.createElement("label",null,"Pseudo ou mail: "),r.a.createElement("input",Object.assign({type:"text"},l))),r.a.createElement("input",{className:"send",type:"submit",value:"Envoyer"}))))},{path:"/connexion/oublie"}),r.a.createElement(ke,{path:"/motdepasse/:token"}),r.a.createElement(function(){var e=Object(n.useContext)(m).state;return e.login?r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement(Se,{state:e})):r.a.createElement(N,null)},{path:"/profil"}),r.a.createElement(N,{default:!0})))),document.getElementById("root"))},52:function(e,t,a){},53:function(e,t,a){},80:function(e,t,a){},86:function(e,t,a){e.exports=a(167)}},[[86,1,2]]]);
//# sourceMappingURL=main.7fb6e562.chunk.js.map